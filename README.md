
<!-- README.md is generated from README.Rmd. Please edit that file -->

# c13ms

<!-- badges: start -->
<!-- badges: end -->

Analysis of isotope-labelled metabolomics data

### Introduction

``` r
C13 <- exampleTracerExperiment(nsamples = 6, nmets = 8)

colnames(C13)
metnames(C13)
rownames(C13)

colData(C13)
C13$group

C13 %>% subset(group == "A")
C13groups <- split(C13, by = ~ group)
C13 <- with(C13groups, A + B)

metData(C13)
isoData(C13)

assay(C13, "raw")
```

## Workflow

A typical analysis workflow may look like as demonstrated below:

``` r
C13 %<>% impute(assay = "raw")
C13 %<>% correctIso()
C13 %<>% normalize(method = ~ COLSUM)
Normalization using normCOLSUM 

assay(C13, "mid") <- MID(C13)
assay(C13, "frac", type = "met") <- isoEnrichment(C13)
assay(C13, "norm", type = "met") <- sumMets(C13)

contrasts <- list(groupBvsA = list("group" = c("B", "A")))

C13 %<>% diffTest(contrasts = contrasts, formula = ~ group, type = "met", method = "limma", assay = "norm")
C13 %<>% diffTest(contrasts = contrasts, formula = ~ group, type = "met", method = "beta", assay = "frac")
C13 %<>% diffTest(contrasts = contrasts, formula = ~ group, type = "iso", method = "beta", assay = "mid")

results(C13, "iso")
$beta
$beta$groupBvsA
                 pval          diff          lfc         padj     padj_all
bqw_m0   2.619315e-01  0.0000000000          NaN 1.0000000000 1.0000000000
bqw_m1   1.199984e-01 -0.0164956831 -0.465929851 1.0000000000 1.0000000000
bqw_m2   8.107092e-01  0.0034043582  0.030496636 1.0000000000 1.0000000000
bqw_m3   9.711581e-01  0.0000000000          NaN 1.0000000000 1.0000000000
bqw_m4   7.992872e-01 -0.0010141333 -0.015415834 1.0000000000 1.0000000000
bqw_m5   1.077396e-02  0.0150968889  0.152456962 0.5494720354 0.5494720354
bqw_m6   1.961663e-03  0.0117685839  0.316867869 0.1098531503 0.1098531503
bqw_m7   1.473494e-03  0.0000000000          NaN 0.0839891371 0.0839891371
bqw_m8   7.383424e-01  0.0000000000          NaN 1.0000000000 1.0000000000
bqw_m9   1.754243e-01 -0.0005621419         -Inf 1.0000000000 1.0000000000
el_m0    1.006062e-02  0.0158894514  0.192905886 0.5231523232 0.5231523232
el_m1    4.828109e-01 -0.0039794053 -0.084312485 1.0000000000 1.0000000000
el_m2    8.047991e-01  0.0000000000          NaN 1.0000000000 1.0000000000
el_m3    7.478243e-01  0.0000000000          NaN 1.0000000000 1.0000000000
el_m4    7.246885e-06  0.0000000000          NaN 0.0004348131 0.0004348131
el_m5    6.604162e-01  0.0000000000          NaN 1.0000000000 1.0000000000
el_m6    3.506134e-01  0.0079439548  0.161154221 1.0000000000 1.0000000000
el_m7    8.747653e-01  0.0000000000          NaN 1.0000000000 1.0000000000
el_m8    9.639301e-01 -0.0004844619 -0.006215513 1.0000000000 1.0000000000
el_m9    9.486719e-04 -0.0095916163 -0.159364637 0.0550229710 0.0550229710
mdxw_m0  1.111437e-01  0.0181643476  0.273737683 1.0000000000 1.0000000000
mdxw_m1  5.678403e-01 -0.0091295252 -0.045527056 1.0000000000 1.0000000000
mdxw_m2  8.682731e-01 -0.0018480575 -0.008694831 1.0000000000 1.0000000000
mdxw_m3  5.974279e-01 -0.0073978594 -0.098867347 1.0000000000 1.0000000000
qwslj_m0 7.259786e-01 -0.0038849426 -0.095961905 1.0000000000 1.0000000000
qwslj_m1 2.178065e-01 -0.0099582033 -0.056761136 1.0000000000 1.0000000000
qwslj_m2 2.585992e-01  0.0124683097  0.053942465 1.0000000000 1.0000000000
qwslj_m3 9.116771e-01  0.0011106143  0.010342480 1.0000000000 1.0000000000
uo_m0    7.730484e-01  0.0000000000          NaN 1.0000000000 1.0000000000
uo_m1    7.815741e-01  0.0032236158  0.103560512 1.0000000000 1.0000000000
uo_m2    1.852465e-01  0.0000000000          NaN 1.0000000000 1.0000000000
uo_m3    9.374923e-01  0.0000000000          NaN 1.0000000000 1.0000000000
uo_m4    5.636217e-03 -0.0362794762 -0.813549103 0.3099919191 0.3099919191
uo_m5    7.233196e-01  0.0029444049  0.043809430 1.0000000000 1.0000000000
uo_m6    8.326613e-01 -0.0013127692 -0.020690825 1.0000000000 1.0000000000
uo_m7    3.990975e-01  0.0000000000          NaN 1.0000000000 1.0000000000
uo_m8    4.358616e-01  0.0045632102  0.198306091 1.0000000000 1.0000000000
uo_m9    1.738854e-02  0.0220632425  0.484152792 0.8694269136 0.8694269136
nvux_m0  4.428997e-01  0.0137514983  0.052153461 1.0000000000 1.0000000000
nvux_m1  7.047799e-01  0.0000000000          NaN 1.0000000000 1.0000000000
nvux_m2  3.955159e-02  0.0171551324  0.338180376 1.0000000000 1.0000000000
nvux_m3  7.675333e-03 -0.0307392896 -0.146180675 0.4144679971 0.4144679971
nvux_m4  7.918991e-01 -0.0014352515 -0.135777663 1.0000000000 1.0000000000
zce_m0   1.778956e-02  0.0000000000          NaN 0.8716885247 0.8716885247
zce_m1   7.664462e-01  0.0000000000          NaN 1.0000000000 1.0000000000
zce_m2   5.960465e-01 -0.0024627389 -0.015867480 1.0000000000 1.0000000000
zce_m3   9.016252e-03 -0.0115576409 -0.565298718 0.4778613363 0.4778613363
zce_m4   7.291165e-02  0.0137183729  0.088869130 1.0000000000 1.0000000000
zce_m5   7.333832e-01  0.0033015779  0.058770777 1.0000000000 1.0000000000
zce_m6   3.150707e-01  0.0057660290  0.274241181 1.0000000000 1.0000000000
slkza_m0 8.328087e-01  0.0000000000          NaN 1.0000000000 1.0000000000
slkza_m1 7.075846e-01  0.0000000000          NaN 1.0000000000 1.0000000000
slkza_m2 3.801419e-01  0.0000000000          NaN 1.0000000000 1.0000000000
slkza_m3 5.530807e-02  0.0000000000          NaN 1.0000000000 1.0000000000
slkza_m4 4.312356e-01 -0.0064320780 -0.078842864 1.0000000000 1.0000000000
slkza_m5 3.448606e-05 -0.0241897158 -0.279563869 0.0020346776 0.0020346776
slkza_m6 8.145793e-01  0.0000000000          NaN 1.0000000000 1.0000000000
slkza_m7 3.147118e-01  0.0076698642  0.163612228 1.0000000000 1.0000000000
slkza_m8 5.470717e-02  0.0135915391  0.167000203 1.0000000000 1.0000000000
slkza_m9 1.270434e-01  0.0000000000          NaN 1.0000000000 1.0000000000
```

## Visualization

``` r
isoplot(C13, mets = metnames(C13)[1])
```

<img src="man/figures/README-unnamed-chunk-5-1.svg" width="100%" />
